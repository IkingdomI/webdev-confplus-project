// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema
generator client {
    provider = "prisma-client-js"
}

generator dbml {
    provider = "prisma-dbml-generator"
}

datasource db {
    provider = "sqlite"
    url      = env("DATABASE_URL")
}

//create a new model called user with the following fields id, first_name, last_name, password, role
model User {
    id         Int      @id @default(autoincrement())
    first_name String
    last_name  String
    password   String
    role       String
    reviews    Review[] //We will enforce the relationship based on roles.
}

model Time {
    id       Int       @id @default(autoincrement())
    time     String    @unique
    sessions Session[]
}

model Paper {
    id        Int      @id @default(autoincrement())
    title     String
    authors   Author[]
    abstract  String
    presenter Int
    reviews   Review[]
    score     Float?
    session   Session  @relation(fields: [sessionId], references: [id])
    sessionId Int
}

model Author {
    id          Int         @id @default(autoincrement())
    fname       String
    lname       String
    email       String      @unique

    paper       Paper       @relation(fields: [paperId], references: [id])
    paperId     Int

    affiliation Institution @relation(fields: [instID], references: [id])
    instID      Int

    sessions Session[]
}

model Review {
    id           Int    @id @default(autoincrement())
    evaluation   Int
    contribution Int
    strength     String
    weakness     String

    reviewer   User @relation(fields: [reviewerID], references: [id])
    reviewerID Int

    paper   Paper @relation(fields: [paperId], references: [id])
    paperId Int
}

model Session {
    id    Int    @id @default(autoincrement())
    title String @unique

    presenter Author @relation(fields: [presentID], references: [id])
    presentID Int

    location Location @relation(fields: [locID], references: [id])
    locID    Int

    date   Condates @relation(fields: [dateID], references: [id])
    dateID Int

    time   Time    @relation(fields: [timeID], references: [id])
    timeID Int

    papers  Paper[]
}

model Location {
    id       Int       @id @default(autoincrement())
    value    String    @unique
    name     String
    sessions Session[]
}

model Institution {
    id      Int      @id @default(autoincrement())
    value   String   @unique
    name    String
    authors Author[]
}

model Condates {
    id       Int       @id @default(autoincrement())
    date     String    @unique
    sessions Session[]
}
